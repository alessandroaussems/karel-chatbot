{"version":3,"sources":["main.js"],"names":["sendMessage","value","event","keyCode","message","document","getElementsByClassName","createUserMessage","removeTypeIcon","createTypeIcon","allowToSend","xmlhttp","XMLHttpRequest","onreadystatechange","readyState","status","console","log","this","responseText","replace","startPusherListening","createAnswer","open","send","listitem","createElement","className","createTextNode","appendChild","messageList","scrollIntoView","setTimeout","innerHTML","BOTTHINKINGTIME","i","span","typingindicator","removeChild","getCookie","cname","name","decodedCookie","decodeURIComponent","cookie","ca","split","length","c","charAt","substring","indexOf","doKdGLogin","login","getElementById","password","button","loader","sessionid","disabled","classList","add","response","JSON","parse","remove","setRequestHeader","showLoginForm","hideLoginForm","pusher","subscribe","bind","data","welcomemessage","Pusher","cluster","encrypted","addEventListener","alert"],"mappings":"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","file":"../js/scripts.min.js","sourcesContent":["var messageList=document.getElementById(\"messagelist\");\nvar BOTTHINKINGTIME=3000;\nvar welcomemessage=\"Hallo ik ben Karel! Stel je vragen maar!\";\nvar allowToSend=true;\nvar pusher = new Pusher('d1252be87affbc8ff537', {cluster: 'eu', encrypted: false});\nfunction sendMessage(value,event)\n{\n    if(event.keyCode === 13 || value===\"getit\")//IF ENTER KEY IS PRESSED OR SEND BUTTON\n    {\n        if(value===\"getit\")\n        {\n            var message=document.getElementsByClassName(\"userinput\")[0].value;\n        }\n        else\n        {\n            var message=value;\n        }\n        createUserMessage(message);\n        document.getElementsByClassName(\"userinput\")[0].value=\"\";\n        //MAKE SURE TYPEICON IS ALWAYS @ THE BOTTOM\n        removeTypeIcon();//REMOVE OLD TYPE ICON\n        createTypeIcon();//CREATE NEW TYPE ICON\n        if(allowToSend)//CHECK IF NO PREVIOUS REQUEST IS STILL EXECUTING\n        {\n            allowToSend=false; // BECAUSE WE START EXECUTING A NEW REQUEST\n            //AJAX CALL TO OUR API\n            var xmlhttp;\n            xmlhttp = new XMLHttpRequest();\n            xmlhttp.onreadystatechange = function(){\n                if (xmlhttp.readyState == 4 && xmlhttp.status == 200){\n                    console.log(this.responseText.replace(/<[^>]+>/g, '').replace(/\\s/g, ''));\n                    if(this.responseText.replace(/<[^>]+>/g, '').replace(/\\s/g, '')===\"startlistening\")\n                    {\n                        startPusherListening();\n                        createAnswer(\"Oke! No hard feelings...Vanaf nu ben je aan het chatten met een medewerken van KdG. Stel je vragen maar!\")\n                    }\n                    else\n                    {\n                       createAnswer(this.responseText);\n                    }\n                }\n                if(xmlhttp.readyState == 4 && xmlhttp.status == 500)\n                {\n                    createAnswer(\"<p>Whoops er ging iets fout. Je mag nu een mail sturen naar <a href='mailto:alessandro.aussems@student.kdg.be'>alessandro.aussems@student.kdg.be</a></p>\");\n                }\n            };\n            xmlhttp.open(\"GET\", \"./chat/\"+message, true);\n            xmlhttp.send();\n        }\n    }\n\n}\nfunction createUserMessage(message)\n{\n    //ADDING THE USER'S MESSAGE TO THE DOM\n    var listitem=document.createElement(\"li\");\n    listitem.className=\"usermessage\";\n    message=document.createTextNode(message);\n    listitem.appendChild(message);\n    messageList.appendChild(listitem);\n    messageList.scrollIntoView(false);\n}\nfunction createAnswer(message)\n{\n        //WAIT BOTTHIKNINGTIME THEN REMOVE TYPING ICON AND CREATE RESPONSE\n        setTimeout(function(){\n            removeTypeIcon();\n            var listitem=document.createElement(\"li\");\n            listitem.className=\"botmessage\";\n            //message=document.createTextNode(message);\n            listitem.innerHTML=message;\n            messageList.appendChild(listitem);\n            messageList.scrollIntoView(false);\n            allowToSend=true; // THIS REQUEST IS FINISHED SO THE NEXT ONE IS NOW ALLOWED\n        }, BOTTHINKINGTIME);\n}\nfunction createTypeIcon()\n{\n    //CREATING TYPING ICON HERE\n    var listitem=document.createElement(\"li\");\n    listitem.className=\"typing-indicator botmessage\";\n    for(var i=0;i<3;i++)\n    {\n        var span=document.createElement(\"span\");\n        listitem.appendChild(span);\n    }\n    messageList.appendChild(listitem);\n    messageList.scrollIntoView(false);\n}\nfunction removeTypeIcon()\n{\n    var typingindicator=document.getElementsByClassName(\"typing-indicator\")[0];\n    if(typingindicator)//IF THE ELEMENT EXISTS THEN REMOVE\n    {\n        messageList.removeChild(typingindicator);\n    }\n}\nfunction getCookie(cname) {\n    var name = cname + \"=\";\n    var decodedCookie = decodeURIComponent(document.cookie);\n    var ca = decodedCookie.split(';');\n    for(var i = 0; i <ca.length; i++) {\n        var c = ca[i];\n        while (c.charAt(0) == ' ') {\n            c = c.substring(1);\n        }\n        if (c.indexOf(name) == 0) {\n            return c.substring(name.length, c.length);\n        }\n    }\n    return \"\";\n}\nfunction doKdGLogin(event)\n{\n    var login=document.getElementById(\"login\").value;\n    var password=document.getElementById(\"password\").value;\n    var button=document.getElementById(\"loginbutton\");\n    var loader=document.getElementById(\"loading\");\n    var sessionid=getCookie(\"chatsession\");\n    button.disabled=true;\n    button.classList.add(\"nodisplay\");\n    loader.classList.add(\"display\");\n    var xmlhttp;\n    xmlhttp = new XMLHttpRequest();\n    xmlhttp.onreadystatechange = function(){\n        if (xmlhttp.readyState == 4 && xmlhttp.status == 200){\n            var response =JSON.parse(this.responseText);\n            if(response)\n            {\n                document.getElementById(\"overlay\").classList.remove(\"display\");\n                document.getElementById(\"kdgconnect\").classList.add(\"nodisplay\");\n                createAnswer(\"Dankjewel om je KdG-account te koppelen! Ik kan je nu nog beter helpen!\")\n            }\n            console.log(response);\n            if(!response)\n            {\n                button.disabled=false;\n                button.classList.remove(\"nodisplay\");\n                loader.classList.remove(\"display\");\n                document.getElementById(\"loginerror\").classList.add(\"display\");\n            }\n        }\n    };\n    xmlhttp.open('PUT', \"./kdglogin/\", true);\n    xmlhttp.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n    xmlhttp.send(\"login=\"+login+\"&password=\"+password+\"&chatsession=\"+sessionid);\n\n}\nfunction showLoginForm(event)\n{\n    document.getElementById(\"overlay\").classList.add(\"display\");\n}\nfunction hideLoginForm(event)\n{\n    document.getElementById(\"overlay\").classList.remove(\"display\");\n}\nfunction startPusherListening()\n{\n    pusher.subscribe(getCookie(\"chatsession\")).bind('chatmessage', function(data)\n    {\n        createAnswer(data.message)\n    });\n}\ndocument.addEventListener(\"DOMContentLoaded\", function(event) {\n    if(getCookie(\"visits\")!=\"\" && getCookie(\"visits\")==1)//CHECK IF COOKIE VISITS EXISTS AND IF FIRST TIME USER VISITS PAGE\n    {\n        setTimeout(function(){\n            createTypeIcon();\n            createAnswer(welcomemessage);\n        }, 1000);\n    }\n    if(getCookie(\"listen\")===\"true\")\n    {\n        alert(\"Listening\");\n        startPusherListening();\n    }\n});"]}